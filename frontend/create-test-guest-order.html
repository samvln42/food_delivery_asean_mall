<!DOCTYPE html>
<html>
<head>
    <title>‡∏™‡∏£‡πâ‡∏≤‡∏á Guest Order ‡∏ó‡∏î‡∏™‡∏≠‡∏ö</title>
    <style>
        body { font-family: Arial; margin: 20px; }
        .log { background: #f0f0f0; padding: 10px; height: 300px; overflow-y: auto; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
        button { margin: 5px; padding: 10px; }
        .section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; }
    </style>
</head>
<body>
    <h1>üõí ‡∏™‡∏£‡πâ‡∏≤‡∏á Guest Order ‡∏ó‡∏î‡∏™‡∏≠‡∏ö</h1>
    
    <div class="section">
        <h3>üìù ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Guest Order</h3>
        <div>
            <label>Temporary ID: </label>
            <input type="text" id="tempId" value="GUEST-A1B2C3D4" readonly>
        </div>
        <div>
            <label>Customer Name: </label>
            <input type="text" id="customerName" value="Test Customer">
        </div>
        <div>
            <label>Customer Phone: </label>
            <input type="text" id="customerPhone" value="0812345678">
        </div>
        <div>
            <label>Delivery Address: </label>
            <input type="text" id="deliveryAddress" value="123 Test Street">
        </div>
        <button onclick="createGuestOrder()">‡∏™‡∏£‡πâ‡∏≤‡∏á Guest Order</button>
    </div>
    
    <div class="section">
        <h3>üìä ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</h3>
        <div class="log" id="log"></div>
    </div>

    <script>
        function log(msg, type = 'info') {
            const logDiv = document.getElementById('log');
            const time = new Date().toLocaleTimeString();
            logDiv.innerHTML += `<div class="${type}">[${time}] ${msg}</div>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        async function createGuestOrder() {
            try {
                log('üõí ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á Guest Order...', 'info');
                
                const orderData = {
                    temporary_id: document.getElementById('tempId').value,
                    customer_name: document.getElementById('customerName').value,
                    customer_phone: document.getElementById('customerPhone').value,
                    delivery_address: document.getElementById('deliveryAddress').value,
                    restaurant: 1, // ‡πÉ‡∏ä‡πâ restaurant ID 1
                    order_items: [
                        {
                            product_id: 1, // ‡πÉ‡∏ä‡πâ product ID 1
                            quantity: 2,
                            unit_price: "100.00",
                            total_price: "200.00"
                        }
                    ],
                    delivery_fee: "50.00"
                };

                log('üì¶ Order Data: ' + JSON.stringify(orderData, null, 2), 'info');

                const response = await fetch('http://localhost:8000/api/guest-orders/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(orderData)
                });

                if (response.ok) {
                    const result = await response.json();
                    log('‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á Guest Order ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
                    log('üìã Guest Order ID: ' + result.guest_order_id, 'success');
                    log('üé´ Temporary ID: ' + result.temporary_id, 'success');
                    log('üí∞ Total Amount: ' + result.total_amount, 'success');
                    
                    // ‡πÅ‡∏™‡∏î‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏´‡∏ô‡πâ‡∏≤ guest orders
                    const guestOrdersUrl = `http://localhost:5173/guest-orders?temporary_id=${result.temporary_id}`;
                    log('üîó ‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏´‡∏ô‡πâ‡∏≤ Guest Orders:', 'info');
                    log(`<a href="${guestOrdersUrl}" target="_blank">${guestOrdersUrl}</a>`, 'info');
                    
                } else {
                    const error = await response.text();
                    log('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error, 'error');
                }

            } catch (error) {
                log('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message, 'error');
            }
        }

        // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
        log('üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á Guest Order ‡∏ó‡∏î‡∏™‡∏≠‡∏ö', 'info');
        log('üí° ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡∏™‡∏£‡πâ‡∏≤‡∏á Guest Order" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏î‡∏™‡∏≠‡∏ö', 'info');
        log('üí° ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏´‡∏ô‡πâ‡∏≤ Guest Orders', 'info');
    </script>
</body>
</html> 